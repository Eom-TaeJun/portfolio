================================================================================
연방기금금리(Federal Funds Rate) 예측 프로젝트
================================================================================

작성일: 2025년
프로젝트 위치: /home/tj/portfolio/02_data_analysis/nonmoon/

================================================================================
1. 연구 주제 및 연구질문
================================================================================

【연구 주제】
머신러닝을 활용한 미국 연방기금금리(Federal Funds Rate) 예측 및
주요 경제 지표의 영향력 분석

【핵심 연구질문】
1) 다양한 거시경제 지표들을 활용하여 연방기금금리를 예측할 수 있는가?
2) 어떤 경제 지표들이 연방기금금리 결정에 가장 큰 영향을 미치는가?
3) 각 경제 지표가 금리에 미치는 영향의 방향과 크기는 어떠한가?
4) CME(Chicago Mercantile Exchange) 시장의 금리 기대치를 경제 지표로
   설명할 수 있는가?

【연구 배경】
연방준비제도(Federal Reserve)의 금리 정책은 미국 경제뿐만 아니라 글로벌
경제에 중대한 영향을 미칩니다. 본 연구는 머신러닝 기법을 활용하여 금리
결정의 복잡한 메커니즘을 이해하고, 주요 경제 지표의 상대적 중요도를
정량화하는 것을 목표로 합니다.

================================================================================
2. 데이터 설명 및 출처
================================================================================

【데이터 출처】
- FRED (Federal Reserve Economic Data) - 미국 연방준비은행 공식 데이터베이스
- CME Group - 연방기금금리 선물 옵션 시장 데이터
- BLS (Bureau of Labor Statistics) - 고용 데이터

【데이터 기간】
- 전체 데이터 수집 범위: 1946년 ~ 2025년
- 실제 분석 기간: 2018년 5월 ~ 2025년
  * 분석 시작 시점이 2018년 5월인 이유: SOFR(Secured Overnight Financing
    Rate)가 2018년 4월에 도입되었으며, 모든 변수에 대한 완전한 데이터를
    확보하기 위해 결측값이 없는 2018년 5월부터 분석 수행

【데이터 구성】
총 37개의 경제 지표 + 1개의 목표변수(FEDFUNDS)

▶ 목표 변수 (Target Variable)
  - FEDFUNDS: 연방기금금리 (Federal Funds Effective Rate)

▶ 설명 변수 (Explanatory Variables)

1) 금융시장 금리 지표 (10개)
  - SOFR: 담보부 익일물 조달금리
  - EFFR: 유효 연방기금금리
  - DGS10: 10년물 국채 수익률
  - DGS2: 2년물 국채 수익률
  - DGS3MO: 3개월물 국채 수익률
  - T10Y2Y: 10년-2년 국채 수익률 스프레드 (장단기 금리차)
  - T10Y3M: 10년-3개월 국채 수익률 스프레드
  - DFII10: 10년물 물가연동 국채 수익률
  - DFEDTARU: 연방기금금리 목표범위 상한
  - DFEDTARL: 연방기금금리 목표범위 하한

2) 노동시장 지표 (3개)
  - PAYEMS: 비농업 총고용 (Total Nonfarm Payroll)
  - UNRATE: 실업률 (Unemployment Rate)
  - CIVPART: 경제활동참가율 (Civilian Labor Force Participation Rate)

3) 물가 지표 (4개)
  - CPIAUCSL: 소비자물가지수 (전 도시 소비자 기준)
  - CPILFESL: 근원 소비자물가지수 (식품 및 에너지 제외)
  - PCEPI: 개인소비지출 물가지수
  - PCEPILFE: 근원 개인소비지출 물가지수 (식품 및 에너지 제외)
  - PPIACO: 생산자물가지수

4) 경제성장 및 생산 지표 (3개)
  - GDP: 명목 국내총생산
  - GDPC1: 실질 국내총생산
  - INDPRO: 산업생산지수 (Industrial Production Index)

5) 재정 지표 (2개)
  - GFDEGDQ188S: 연방정부 부채 대비 GDP 비율
  - MTSDS133FMS: 미국 재무부 월별 재정수지

6) 주택시장 지표 (4개)
  - HOUST: 주택착공 건수 (Housing Starts)
  - PERMIT: 건축허가 건수 (Building Permits)
  - USSTHPI: 미국 주택가격지수
  - SPCS20RSA: S&P 케이스-쉴러 20개 도시 주택가격지수

7) 신용 및 통화 지표 (2개)
  - BUSLOANS: 상업 및 산업 대출
  - M2SL: 통화량 M2

8) 소비 및 판매 지표 (1개)
  - RSAFS: 소매판매 (Retail Sales)

9) 금융시장 상황 지표 (4개)
  - NFCI: 국가금융상황지수 (National Financial Conditions Index)
  - SP500: S&P 500 지수
  - VIXCLS: VIX 변동성 지수
  - UMCSENT: 미시간대 소비자심리지수

10) 환율 및 원자재 지표 (3개)
  - DTWEXBGS: 달러인덱스 (Dollar Index - Broad Goods and Services)
  - DCOILBRENTEU: 브렌트유 가격
  - DCOILWTICO: WTI 원유 가격

【데이터 전처리】
1) 시계열 데이터 통합: 모든 경제 지표를 날짜 기준으로 병합
2) 빈도 조정: 분기별 데이터(예: GDP)를 월별 데이터로 변환 (순방향 채우기)
3) 결측값 처리:
   - 월별 리샘플링 후 순방향 채우기(forward-fill) 적용
   - 모든 변수에 완전한 데이터가 있는 관측치만 사용
   - 결측값(NaN)이 포함된 행 제거
4) 데이터 정규화: 모든 수치형 변수를 숫자형으로 변환

【데이터 특성】
- 총 데이터 포인트: 약 147,874개 (37개 변수 × 시계열 관측치)
- 데이터 빈도: 월별 (Monthly)
- 데이터 형식: CSV 파일
- 데이터 신뢰성: 미국 연방정부 공식 통계 (FRED, BLS)

================================================================================
3. 모형 및 방법론
================================================================================

【분석 프레임워크】
본 연구는 지도학습(Supervised Learning) 중 회귀분석(Regression)을
기반으로 하며, 모델 해석가능성을 강조하는 설명가능 AI(Explainable AI)
기법을 결합한 접근법을 사용합니다.

【주요 모델: Random Forest Regressor (랜덤 포레스트 회귀)】

▶ 모델 선택 이유
1) 비선형성 포착 능력
   - 경제 시스템의 복잡하고 비선형적인 관계를 효과적으로 모델링
   - 변수 간 상호작용 효과를 자동으로 학습

2) 견고성 (Robustness)
   - 이상치(outliers)와 노이즈에 대한 강건성
   - 금융 및 경제 데이터의 높은 변동성을 안정적으로 처리

3) 과적합 방지
   - 여러 결정 트리의 앙상블을 통한 분산 감소
   - 보지 못한 데이터에 대한 우수한 일반화 성능

4) SHAP 분석과의 호환성
   - 트리 기반 모델로서 TreeExplainer를 통한 효율적 설명
   - 각 변수의 기여도를 정확하게 계산 가능

▶ 모델 사양
- 알고리즘: Random Forest Regressor (Scikit-learn)
- 트리 개수(n_estimators): 100
- 랜덤 시드(random_state): 42 (재현성 확보)
- 병렬 처리(n_jobs): -1 (모든 CPU 코어 활용)
- 기타 하이퍼파라미터: 기본값 사용

▶ 학습 및 검증
- 데이터 분할 방식: 시계열 기반 분할 (Time-based Split)
  * 학습 데이터: 전체 데이터의 처음 80%
  * 테스트 데이터: 전체 데이터의 마지막 20%
  * shuffle=False: 시계열 순서 유지 (시간 정보 누출 방지)

【설명가능 AI: SHAP (SHapley Additive exPlanations) 분석】

▶ SHAP 분석 목적
랜덤 포레스트는 높은 예측 성능을 보이지만 "블랙박스" 특성으로 인해
해석이 어렵습니다. SHAP 분석은 게임이론의 Shapley Value 개념을 적용하여
각 변수가 예측값에 기여하는 정도를 정량화합니다.

▶ SHAP 분석 방법
1) TreeExplainer 사용
   - 트리 기반 모델에 최적화된 SHAP 계산 알고리즘
   - 빠르고 정확한 특성 중요도 계산

2) SHAP 값 계산
   - 각 관측치에 대해 각 변수의 기여도를 계산
   - 기여도는 양수(금리 상승 방향) 또는 음수(금리 하락 방향)

3) 특성 중요도 집계
   - 평균 절대 SHAP 값(Mean Absolute SHAP Value) 계산
   - 변수별 상대적 중요도 순위 도출

▶ SHAP 시각화
1) SHAP Summary Plot (Bar Chart)
   - 각 변수의 평균 절대 SHAP 값을 막대그래프로 표시
   - 변수 중요도의 상대적 비교 가능
   - 출력 파일: shap_summary_plot.png

2) Decision Tree Visualization
   - 앙상블 내 개별 트리의 구조 시각화
   - 변수 분기 규칙 및 의사결정 과정 이해
   - 출력 파일: tree.dot, tree.png

【추가 분석: CME 시장 기대치 분석】

▶ 분석 1: CME Fed Meeting Expectations (target2_analysis.py)
- 목표 변수: CME 선물 시장이 예상하는 연준 회의별 금리 (expected_rate)
- 계산 방식: 확률 가중 평균
  * 각 금리 구간별 확률 × 구간 중간값의 합
- 연준 회의 데이터: 2025-2026년 향후 회의 일정 포함
- 분석 목적: 시장 기대치를 경제 지표로 설명 가능한지 검증

▶ 분석 2: CME Target Rate Analysis (cme_analysis.py)
- 목표 변수: CME 옵션 시장의 기대 금리(exp_rate_bp, 베이시스 포인트 단위)
- 특수 처리: DGS2 (2년물 국채 수익률) 제외
  * 금리 선물과의 높은 상관관계로 인한 내생성 문제 회피
- 분석 목적: 시장 기대치 형성에 영향을 미치는 경제 펀더멘털 파악

【분석 프로세스】

단계 1: 데이터 준비 (data_prep.py)
├─ 1.1 목표 변수(FEDFUNDS) 로드
├─ 1.2 설명 변수(37개 FRED 지표) 로드
├─ 1.3 날짜 기준 데이터 병합
├─ 1.4 분기 데이터를 월별로 변환 (순방향 채우기)
├─ 1.5 결측값 제거
└─ 1.6 정제된 데이터 저장 (prepared_data.csv)

단계 2: 모델 학습 및 분석 (analysis.py)
├─ 2.1 정제된 데이터 로드
├─ 2.2 시계열 기반 데이터 분할 (80% 학습, 20% 테스트)
├─ 2.3 Random Forest 모델 학습
├─ 2.4 SHAP 분석 수행
│   ├─ TreeExplainer 초기화
│   ├─ 테스트 데이터에 대한 SHAP 값 계산
│   └─ 평균 절대 SHAP 값으로 특성 중요도 산출
├─ 2.5 시각화 생성
│   ├─ SHAP Summary Plot 생성 및 저장
│   └─ Decision Tree 시각화
└─ 2.6 정량적 분석 결과 출력

단계 3: 확장 분석
├─ 3.1 CME 연준 회의 기대치 분석 (target2_analysis.py)
│   ├─ 회의별 확률 분포 데이터 로드
│   ├─ 기대 금리 계산 (확률 가중 평균)
│   ├─ FRED 지표와 병합
│   └─ 통합 SHAP 분석 및 회의별 분석
└─ 3.2 CME 옵션 시장 분석 (cme_analysis.py)
    ├─ CME 타깃 패널 데이터 로드
    ├─ DGS2 제외한 설명변수 준비
    └─ 시장 기대치 예측 모델 및 SHAP 분석

【평가 지표】
- 특성 중요도: 평균 절대 SHAP 값 (Mean Absolute SHAP Value)
- 해석 방향: SHAP 값의 부호 (양수=금리 상승 기여, 음수=금리 하락 기여)
- 시각적 평가: SHAP Summary Plot을 통한 변수별 중요도 비교

【방법론의 강점】
1) 해석 가능성: SHAP 분석을 통한 명확한 인과관계 설명
2) 비선형 관계 포착: 복잡한 경제 시스템의 비선형 동학 모델링
3) 견고성: 이상치와 노이즈에 강건한 앙상블 기법
4) 시계열 보존: 미래 정보 누출 방지를 위한 시간 순서 유지
5) 다차원 분석: 37개 변수의 동시적 영향 분석 가능

【방법론의 한계 및 고려사항】
1) 인과관계 vs 상관관계: 머신러닝 모델은 상관관계를 포착하지만,
   인과관계를 보장하지는 않음
2) 구조적 변화: 경제 구조가 변화하는 경우 모델 재학습 필요
3) 외생적 충격: 팬데믹, 금융위기 등 비정상적 사건에 대한 예측 한계
4) 시차 효과: 경제 지표의 시차 효과를 명시적으로 모델링하지 않음

================================================================================
4. 기대 효과 및 활용 방안
================================================================================

【학술적 기여】
- 머신러닝 기법을 활용한 통화정책 분석의 새로운 접근법 제시
- 경제 지표의 상대적 중요도에 대한 실증적 증거 제공
- 설명가능 AI를 경제학 분석에 적용한 방법론적 사례

【실무적 활용】
- 중앙은행 정책 방향 예측을 위한 의사결정 지원
- 금융기관의 금리 리스크 관리 및 헤지 전략 수립
- 경제 예측 모델의 성능 개선을 위한 변수 선택 지침

【정책적 시사점】
- 연준의 금리 결정에 영향을 미치는 주요 경제 지표 파악
- 통화정책 전달 메커니즘의 이해 증진
- 시장 기대치와 경제 펀더멘털 간 관계 분석

================================================================================
5. 프로젝트 파일 구조
================================================================================

/home/tj/portfolio/02_data_analysis/nonmoon/
│
├── fred/                          # 원시 FRED 데이터 (37개 CSV 파일)
│   ├── FEDFUNDS.csv
│   ├── SOFR.csv
│   ├── CPIAUCSL.csv
│   └── ... (34개 추가 지표)
│
├── fred3/                         # 보간 처리된 FRED 데이터
│   └── *_interpolated.csv
│
├── target1/                       # 연방기금금리 목표 데이터
│   └── FEDFUNDS.csv
│
├── target2/                       # CME 연준 회의 기대치 데이터
│   ├── FedMeetings_concat.csv   # 통합 회의 데이터
│   ├── cme_targets_panel.csv    # CME 패널 데이터
│   └── FedMeeting_*.csv         # 개별 회의별 확률 분포
│
├── ecofile/                       # 추가 경제 지표 파일
│   ├── Employment Situation News Release (PDF)
│   └── 기타 경제 데이터
│
└── /home/tj/portfolio/02_data_analysis/working/
    ├── data_prep.py              # 데이터 전처리 스크립트
    ├── analysis.py               # 메인 분석 스크립트 (SHAP 포함)
    ├── target2_analysis.py       # CME 회의 기대치 분석
    ├── cme_analysis.py           # CME 옵션 시장 분석
    ├── prepared_data.csv         # 전처리 완료 데이터
    ├── shap_summary_plot.png     # SHAP 요약 플롯
    ├── consolidated_shap_plot.png # 통합 SHAP 플롯
    ├── tree.dot                  # 의사결정 트리 (DOT 형식)
    └── explanation.txt           # 프로젝트 설명 문서

================================================================================
6. 참고문헌 및 데이터 출처
================================================================================

【데이터 출처】
- Federal Reserve Bank of St. Louis. "Federal Reserve Economic Data (FRED)."
  https://fred.stlouisfed.org/

- CME Group. "Fed Fund Futures and Options."
  https://www.cmegroup.com/

- U.S. Bureau of Labor Statistics. "Employment Situation Summary."
  https://www.bls.gov/

【주요 라이브러리】
- scikit-learn: Machine Learning 모델 구현
- SHAP: 모델 해석 및 특성 중요도 분석
- pandas: 데이터 조작 및 전처리
- numpy: 수치 계산
- matplotlib: 시각화

【방법론 참고】
- Lundberg, S. M., & Lee, S. I. (2017). "A Unified Approach to Interpreting
  Model Predictions." Advances in Neural Information Processing Systems.

- Breiman, L. (2001). "Random Forests." Machine Learning, 45(1), 5-32.

================================================================================
문서 끝
================================================================================

※ 본 문서는 학술 및 연구 목적으로 작성되었습니다.
※ 투자 결정이나 정책 수립에 활용 시 추가적인 검증이 필요합니다.
